
Deprecated: The each() function is deprecated. This message will be suppressed on further calls in C:\Users\deix\AppData\Roaming\Sublime Text 3\Packages\PHPTools\php.tools\codeFormatter.php on line 54
<?php
class FileSearch {
	/**
	 *Установка стартового времени
	 **/
	public $time = microtime(true);
	/**
	 *Создание файла со значениями
	 **/
	public function createFileAndValues(string $fileName, int $count) {
		$file = fopen($fileName, "w");
		for ($i = 0; $i < $count; $i++) {
			fwrite($file, "ключ".$i."\t"."значение".$i."\x0A");
		}
	}
	/**
	 *Поиск в файле значения
	 **/
	public function intoFileSearch(string $file, string $search):string {
		$handle = fopen($file, "r");
		while (!feof($handle)) {
			$string = fgets($handle, 4000);
			mb_convert_encoding($string, 'cp1251');
			$explodedstring = explode('\x0A', $string);
			array_pop($explodedstring);
			foreach ($explodedstring as $key => $value) {
				$arr[] = explode('\t', $value);
			}
			$start = 0;
			$end   = count($arr)-1;
			while ($start <= $end) {
				$calc_mid  = floor(($start+$end)/2);
				$strnatcmp = strnatcmp($arr[$calc_mid][0], $search);
				if ($strnatcmp > 0) {
					$end = $calc_mid-1;
				} elseif ($strnatcmp < 0) {
					$start = $calc_mid+1;
				} else {
					return $arr[$calc_mid][1];
				}
			}
		}
		return 'undef';
	}
}
$file = new FileSearch();
$file.createFile("");
?>
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>
<body>

</body>
</html>
